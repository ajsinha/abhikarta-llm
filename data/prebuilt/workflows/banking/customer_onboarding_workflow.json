{
  "workflow_id": "banking_customer_onboarding",
  "name": "Customer Onboarding Workflow",
  "description": "Complete customer onboarding workflow including KYC verification, risk assessment, account creation, and welcome communications.",
  "version": "1.0.0",
  "category": "banking",
  "subcategory": "onboarding",
  "nodes": [
    {
      "id": "start",
      "type": "start",
      "name": "Onboarding Request",
      "config": {},
      "position": {"x": 100, "y": 300}
    },
    {
      "id": "validate_info",
      "type": "code",
      "name": "Validate Customer Info",
      "config": {
        "language": "python",
        "code": "# Validate required customer information\nrequired_fields = ['first_name', 'last_name', 'email', 'phone', 'date_of_birth']\nmissing = [f for f in required_fields if not input_data.get('customer', {}).get(f)]\nresult = {'valid': len(missing) == 0, 'missing_fields': missing}"
      },
      "position": {"x": 300, "y": 300}
    },
    {
      "id": "verify_email",
      "type": "tool",
      "name": "Validate Email",
      "config": {
        "tool_name": "validate_email"
      },
      "position": {"x": 500, "y": 200}
    },
    {
      "id": "verify_phone",
      "type": "tool",
      "name": "Validate Phone",
      "config": {
        "tool_name": "validate_phone"
      },
      "position": {"x": 500, "y": 400}
    },
    {
      "id": "merge_validation",
      "type": "passthrough",
      "name": "Merge Validation",
      "config": {},
      "position": {"x": 700, "y": 300}
    },
    {
      "id": "verify_identity",
      "type": "tool",
      "name": "Verify Identity Document",
      "config": {
        "tool_name": "verify_identity_document"
      },
      "position": {"x": 900, "y": 300}
    },
    {
      "id": "verify_address",
      "type": "tool",
      "name": "Verify Address",
      "config": {
        "tool_name": "verify_address"
      },
      "position": {"x": 1100, "y": 300}
    },
    {
      "id": "sanctions_check",
      "type": "tool",
      "name": "Sanctions Screening",
      "config": {
        "tool_name": "check_sanctions_list"
      },
      "position": {"x": 1300, "y": 300}
    },
    {
      "id": "kyc_risk",
      "type": "tool",
      "name": "Calculate KYC Risk",
      "config": {
        "tool_name": "calculate_kyc_risk_score"
      },
      "position": {"x": 1500, "y": 300}
    },
    {
      "id": "risk_router",
      "type": "condition",
      "name": "Risk Level Check",
      "config": {
        "condition": "risk_level == 'low'",
        "description": "Route based on KYC risk level"
      },
      "position": {"x": 1700, "y": 300}
    },
    {
      "id": "auto_approve",
      "type": "code",
      "name": "Auto Approve Account",
      "config": {
        "language": "python",
        "code": "import uuid\nresult = {\n  'account_number': f'ACC{uuid.uuid4().hex[:10].upper()}',\n  'status': 'approved',\n  'kyc_level': 'standard'\n}"
      },
      "position": {"x": 1900, "y": 200}
    },
    {
      "id": "enhanced_review",
      "type": "hitl",
      "name": "Enhanced Due Diligence",
      "config": {
        "task_type": "edd_review",
        "priority": "high",
        "description": "Customer requires Enhanced Due Diligence review"
      },
      "position": {"x": 1900, "y": 400}
    },
    {
      "id": "generate_account",
      "type": "tool",
      "name": "Generate Account Number",
      "config": {
        "tool_name": "generate_account_number"
      },
      "position": {"x": 2100, "y": 300}
    },
    {
      "id": "welcome_email",
      "type": "llm",
      "name": "Generate Welcome Email",
      "config": {
        "model_id": "gpt-4o",
        "prompt": "Generate a warm and professional welcome email for a new banking customer. Include:\n- Personalized greeting\n- Account details summary\n- Key features and benefits\n- Next steps for getting started\n- Contact information for support",
        "temperature": 0.5
      },
      "position": {"x": 2300, "y": 300}
    },
    {
      "id": "end",
      "type": "end",
      "name": "Onboarding Complete",
      "config": {},
      "position": {"x": 2500, "y": 300}
    }
  ],
  "edges": [
    {"from": "start", "to": "validate_info"},
    {"from": "validate_info", "to": "verify_email"},
    {"from": "validate_info", "to": "verify_phone"},
    {"from": "verify_email", "to": "merge_validation"},
    {"from": "verify_phone", "to": "merge_validation"},
    {"from": "merge_validation", "to": "verify_identity"},
    {"from": "verify_identity", "to": "verify_address"},
    {"from": "verify_address", "to": "sanctions_check"},
    {"from": "sanctions_check", "to": "kyc_risk"},
    {"from": "kyc_risk", "to": "risk_router"},
    {"from": "risk_router", "to": "auto_approve", "condition": "low_risk"},
    {"from": "risk_router", "to": "enhanced_review", "condition": "high_risk"},
    {"from": "auto_approve", "to": "generate_account"},
    {"from": "enhanced_review", "to": "generate_account"},
    {"from": "generate_account", "to": "welcome_email"},
    {"from": "welcome_email", "to": "end"}
  ],
  "input_schema": {
    "type": "object",
    "properties": {
      "customer": {
        "type": "object",
        "properties": {
          "first_name": {"type": "string"},
          "last_name": {"type": "string"},
          "email": {"type": "string"},
          "phone": {"type": "string"},
          "date_of_birth": {"type": "string"},
          "occupation": {"type": "string"},
          "is_pep": {"type": "boolean"}
        }
      },
      "identity_document": {
        "type": "object",
        "properties": {
          "type": {"type": "string"},
          "number": {"type": "string"},
          "issuing_country": {"type": "string"},
          "expiry_date": {"type": "string"}
        }
      },
      "address": {
        "type": "object",
        "properties": {
          "street": {"type": "string"},
          "city": {"type": "string"},
          "state": {"type": "string"},
          "postal_code": {"type": "string"},
          "country": {"type": "string"}
        }
      },
      "account_type": {"type": "string"}
    }
  },
  "tags": ["onboarding", "kyc", "account", "workflow", "banking"],
  "permissions": {
    "allowed_roles": ["agent_developer", "super_admin", "domain_admin"]
  },
  "status": "published",
  "created_at": "2025-01-01T00:00:00Z",
  "author": "Abhikarta System"
}
