{
  "workflow_id": "banking_transaction_monitoring",
  "name": "Transaction Monitoring Workflow",
  "description": "Real-time transaction monitoring workflow for fraud detection, AML compliance, and suspicious activity reporting.",
  "version": "1.0.0",
  "category": "banking",
  "subcategory": "compliance",
  "nodes": [
    {
      "id": "start",
      "type": "start",
      "name": "Transaction Received",
      "config": {},
      "position": {"x": 100, "y": 300}
    },
    {
      "id": "analyze_transaction",
      "type": "tool",
      "name": "Analyze Transaction",
      "config": {
        "tool_name": "analyze_transaction"
      },
      "position": {"x": 300, "y": 300}
    },
    {
      "id": "check_limits",
      "type": "tool",
      "name": "Check Transaction Limits",
      "config": {
        "tool_name": "calculate_transaction_limits"
      },
      "position": {"x": 500, "y": 300}
    },
    {
      "id": "risk_router",
      "type": "condition",
      "name": "Risk Level Router",
      "config": {
        "condition": "risk_level",
        "description": "Route based on transaction risk level"
      },
      "position": {"x": 700, "y": 300}
    },
    {
      "id": "allow_transaction",
      "type": "passthrough",
      "name": "Allow Transaction",
      "config": {},
      "position": {"x": 900, "y": 100}
    },
    {
      "id": "additional_verification",
      "type": "llm",
      "name": "Generate Verification Request",
      "config": {
        "model_id": "gpt-4o",
        "prompt": "Generate an additional verification request for a medium-risk transaction. Include specific questions to verify the transaction legitimacy.",
        "temperature": 0.3
      },
      "position": {"x": 900, "y": 300}
    },
    {
      "id": "block_transaction",
      "type": "code",
      "name": "Block Transaction",
      "config": {
        "language": "python",
        "code": "result = {\n  'action': 'blocked',\n  'reason': 'High risk transaction - requires manual review',\n  'alert_generated': True\n}"
      },
      "position": {"x": 900, "y": 500}
    },
    {
      "id": "pattern_analysis",
      "type": "tool",
      "name": "Detect Patterns",
      "config": {
        "tool_name": "detect_transaction_patterns"
      },
      "position": {"x": 1100, "y": 300}
    },
    {
      "id": "pattern_router",
      "type": "condition",
      "name": "Pattern Alert Router",
      "config": {
        "condition": "suspicious_pattern_detected",
        "description": "Route if suspicious patterns found"
      },
      "position": {"x": 1300, "y": 300}
    },
    {
      "id": "generate_sar",
      "type": "tool",
      "name": "Generate AML Report",
      "config": {
        "tool_name": "generate_aml_report"
      },
      "position": {"x": 1500, "y": 400}
    },
    {
      "id": "hitl_investigation",
      "type": "hitl",
      "name": "Fraud Investigation",
      "config": {
        "task_type": "fraud_investigation",
        "priority": "critical",
        "description": "Suspicious transaction pattern requires investigation"
      },
      "position": {"x": 1700, "y": 400}
    },
    {
      "id": "log_transaction",
      "type": "code",
      "name": "Log Transaction",
      "config": {
        "language": "python",
        "code": "from datetime import datetime\nresult = {\n  'logged': True,\n  'timestamp': datetime.utcnow().isoformat(),\n  'status': 'completed'\n}"
      },
      "position": {"x": 1500, "y": 200}
    },
    {
      "id": "merge_results",
      "type": "passthrough",
      "name": "Merge Results",
      "config": {},
      "position": {"x": 1900, "y": 300}
    },
    {
      "id": "end",
      "type": "end",
      "name": "Monitoring Complete",
      "config": {},
      "position": {"x": 2100, "y": 300}
    }
  ],
  "edges": [
    {"from": "start", "to": "analyze_transaction"},
    {"from": "analyze_transaction", "to": "check_limits"},
    {"from": "check_limits", "to": "risk_router"},
    {"from": "risk_router", "to": "allow_transaction", "condition": "low"},
    {"from": "risk_router", "to": "additional_verification", "condition": "medium"},
    {"from": "risk_router", "to": "block_transaction", "condition": "high"},
    {"from": "allow_transaction", "to": "pattern_analysis"},
    {"from": "additional_verification", "to": "pattern_analysis"},
    {"from": "block_transaction", "to": "pattern_analysis"},
    {"from": "pattern_analysis", "to": "pattern_router"},
    {"from": "pattern_router", "to": "generate_sar", "condition": "suspicious"},
    {"from": "pattern_router", "to": "log_transaction", "condition": "normal"},
    {"from": "generate_sar", "to": "hitl_investigation"},
    {"from": "hitl_investigation", "to": "merge_results"},
    {"from": "log_transaction", "to": "merge_results"},
    {"from": "merge_results", "to": "end"}
  ],
  "input_schema": {
    "type": "object",
    "properties": {
      "transaction": {
        "type": "object",
        "properties": {
          "id": {"type": "string"},
          "type": {"type": "string"},
          "amount": {"type": "number"},
          "currency": {"type": "string"},
          "timestamp": {"type": "string"},
          "source_account": {"type": "string"},
          "destination_account": {"type": "string"},
          "is_international": {"type": "boolean"}
        }
      },
      "account_data": {
        "type": "object",
        "properties": {
          "account_id": {"type": "string"},
          "account_type": {"type": "string"},
          "kyc_level": {"type": "string"},
          "daily_used": {"type": "number"},
          "monthly_used": {"type": "number"}
        }
      },
      "historical_transactions": {"type": "array"}
    }
  },
  "tags": ["fraud", "aml", "monitoring", "compliance", "banking"],
  "permissions": {
    "allowed_roles": ["agent_developer", "super_admin", "domain_admin"]
  },
  "status": "published",
  "created_at": "2025-01-01T00:00:00Z",
  "author": "Abhikarta System"
}
