{
  "workflow_id": "banking_credit_card_application",
  "name": "Credit Card Application Workflow",
  "description": "End-to-end credit card application processing including credit check, limit determination, card issuance, and activation.",
  "version": "1.0.0",
  "category": "banking",
  "subcategory": "lending",
  "nodes": [
    {
      "id": "start",
      "type": "start",
      "name": "Application Submitted",
      "config": {},
      "position": {"x": 100, "y": 300}
    },
    {
      "id": "validate_application",
      "type": "code",
      "name": "Validate Application",
      "config": {
        "language": "python",
        "code": "required = ['applicant_name', 'ssn', 'annual_income', 'employment_status']\nmissing = [f for f in required if not input_data.get(f)]\nresult = {'valid': len(missing) == 0, 'missing': missing}"
      },
      "position": {"x": 300, "y": 300}
    },
    {
      "id": "verify_identity",
      "type": "tool",
      "name": "Verify Identity",
      "config": {
        "tool_name": "verify_identity_document"
      },
      "position": {"x": 500, "y": 300}
    },
    {
      "id": "credit_pull",
      "type": "tool",
      "name": "Credit Bureau Pull",
      "config": {
        "tool_name": "calculate_credit_score"
      },
      "position": {"x": 700, "y": 300}
    },
    {
      "id": "fraud_screening",
      "type": "agent",
      "name": "Application Fraud Check",
      "config": {
        "agent_id": "banking_fraud_detection",
        "prompt": "Screen this credit card application for fraud indicators. Check for synthetic identity, application fraud patterns, and velocity abuse."
      },
      "position": {"x": 900, "y": 300}
    },
    {
      "id": "calculate_dti",
      "type": "tool",
      "name": "Calculate DTI",
      "config": {
        "tool_name": "assess_debt_to_income"
      },
      "position": {"x": 1100, "y": 300}
    },
    {
      "id": "determine_product",
      "type": "llm",
      "name": "Product Selection",
      "config": {
        "model_id": "gpt-4o",
        "prompt": "Based on the applicant's credit profile, recommend the most suitable credit card product:\n- Premium (750+ score): Rewards card with high limit\n- Standard (700-749): Basic rewards card\n- Secured (below 700): Secured credit card\n\nAlso suggest initial credit limit based on income and credit history.",
        "temperature": 0.2
      },
      "position": {"x": 1300, "y": 300}
    },
    {
      "id": "decision_engine",
      "type": "condition",
      "name": "Approval Decision",
      "config": {
        "condition": "credit_score >= 600 && dti_ratio <= 50",
        "description": "Route based on credit and DTI criteria"
      },
      "position": {"x": 1500, "y": 300}
    },
    {
      "id": "approve_card",
      "type": "code",
      "name": "Approve & Set Limits",
      "config": {
        "language": "python",
        "code": "import uuid\ncredit_score = input_data.get('credit_score', 0)\nincome = input_data.get('annual_income', 0)\nbase_limit = min(income * 0.2, 50000)\nif credit_score >= 750:\n    limit = base_limit * 1.5\n    apr = 15.99\nelif credit_score >= 700:\n    limit = base_limit\n    apr = 19.99\nelse:\n    limit = min(base_limit * 0.5, 5000)\n    apr = 24.99\nresult = {'approved': True, 'credit_limit': round(limit, -2), 'apr': apr, 'card_number': f'****-****-****-{uuid.uuid4().int % 10000:04d}'}"
      },
      "position": {"x": 1700, "y": 200}
    },
    {
      "id": "decline_application",
      "type": "llm",
      "name": "Generate Decline Notice",
      "config": {
        "model_id": "gpt-4o",
        "prompt": "Generate an adverse action notice for declined credit card application. Include:\n- Specific reasons for decline\n- Credit bureau used\n- Right to free credit report\n- How to dispute information\n- Alternative options",
        "temperature": 0.3
      },
      "position": {"x": 1700, "y": 400}
    },
    {
      "id": "generate_welcome",
      "type": "llm",
      "name": "Generate Welcome Kit",
      "config": {
        "model_id": "gpt-4o",
        "prompt": "Generate credit card welcome kit content including:\n- Card features and benefits\n- Credit limit and APR\n- Activation instructions\n- Rewards program details\n- Important disclosures",
        "temperature": 0.4
      },
      "position": {"x": 1900, "y": 200}
    },
    {
      "id": "schedule_card",
      "type": "code",
      "name": "Schedule Card Issuance",
      "config": {
        "language": "python",
        "code": "from datetime import datetime, timedelta\nresult = {\n  'card_ordered': True,\n  'estimated_delivery': (datetime.now() + timedelta(days=7)).strftime('%Y-%m-%d'),\n  'tracking_number': f'TRK{datetime.now().strftime(\"%Y%m%d%H%M%S\")}'\n}"
      },
      "position": {"x": 2100, "y": 200}
    },
    {
      "id": "send_notification",
      "type": "tool",
      "name": "Send Notification",
      "config": {
        "tool_name": "create_notification"
      },
      "position": {"x": 2100, "y": 400}
    },
    {
      "id": "end",
      "type": "end",
      "name": "Process Complete",
      "config": {},
      "position": {"x": 2300, "y": 300}
    }
  ],
  "edges": [
    {"from": "start", "to": "validate_application"},
    {"from": "validate_application", "to": "verify_identity"},
    {"from": "verify_identity", "to": "credit_pull"},
    {"from": "credit_pull", "to": "fraud_screening"},
    {"from": "fraud_screening", "to": "calculate_dti"},
    {"from": "calculate_dti", "to": "determine_product"},
    {"from": "determine_product", "to": "decision_engine"},
    {"from": "decision_engine", "to": "approve_card", "condition": "approved"},
    {"from": "decision_engine", "to": "decline_application", "condition": "declined"},
    {"from": "approve_card", "to": "generate_welcome"},
    {"from": "generate_welcome", "to": "schedule_card"},
    {"from": "decline_application", "to": "send_notification"},
    {"from": "schedule_card", "to": "end"},
    {"from": "send_notification", "to": "end"}
  ],
  "input_schema": {
    "type": "object",
    "properties": {
      "applicant_name": {"type": "string"},
      "ssn": {"type": "string"},
      "date_of_birth": {"type": "string"},
      "annual_income": {"type": "number"},
      "employment_status": {"type": "string"},
      "housing_status": {"type": "string"},
      "monthly_housing_payment": {"type": "number"},
      "requested_card_type": {"type": "string"}
    }
  },
  "tags": ["credit_card", "application", "lending", "banking"],
  "permissions": {
    "allowed_roles": ["agent_developer", "super_admin", "domain_admin"]
  },
  "status": "published",
  "created_at": "2025-01-01T00:00:00Z",
  "author": "Abhikarta System"
}
