{
  "workflow_id": "prebuilt-doc-summarizer",
  "name": "Document Summarizer",
  "description": "Summarize long documents with AI. Supports multiple output formats: executive summary, bullet points, or detailed analysis.",
  "version": "1.0.0",
  "category": "content",
  "tags": ["document", "summary", "content", "writing"],
  "is_prebuilt": true,
  
  "python_modules": {
    "text_utils": "def chunk_text(text, max_chars=8000):\n    \"\"\"Split text into chunks for processing.\"\"\"\n    words = text.split()\n    chunks = []\n    current_chunk = []\n    current_len = 0\n    for word in words:\n        if current_len + len(word) > max_chars:\n            chunks.append(' '.join(current_chunk))\n            current_chunk = [word]\n            current_len = len(word)\n        else:\n            current_chunk.append(word)\n            current_len += len(word) + 1\n    if current_chunk:\n        chunks.append(' '.join(current_chunk))\n    return chunks\n\ndef word_count(text):\n    return len(text.split())"
  },
  
  "nodes": {
    "input": {
      "type": "input",
      "name": "Document Input",
      "config": {
        "schema": {
          "type": "object",
          "required": ["document_text"],
          "properties": {
            "document_text": {"type": "string"},
            "summary_type": {"type": "string", "enum": ["executive", "bullets", "detailed"], "default": "executive"},
            "max_length": {"type": "integer", "default": 500}
          }
        }
      }
    },
    
    "analyze_doc": {
      "type": "python",
      "name": "Analyze Document",
      "dependencies": ["input"],
      "code": "from text_utils import chunk_text, word_count\n\ntext = input_data.get('document_text', '')\nword_ct = word_count(text)\nchunks = chunk_text(text)\n\noutput = {\n    'original_text': text,\n    'word_count': word_ct,\n    'chunks': chunks,\n    'chunk_count': len(chunks),\n    'summary_type': input_data.get('summary_type', 'executive'),\n    'max_length': input_data.get('max_length', 500)\n}"
    },
    
    "summarize": {
      "type": "llm",
      "name": "Generate Summary",
      "dependencies": ["analyze_doc"],
      "config": {
        "provider": "openai",
        "model": "gpt-4o-mini",
        "temperature": 0.3,
        "max_tokens": 1000,
        "system_prompt": "You are an expert document summarizer. Create clear, accurate summaries that capture the key information.",
        "prompt": "Summarize the following document.\n\nSummary Type: {input_data.summary_type}\nTarget Length: approximately {input_data.max_length} words\n\nIf 'executive': Write a professional executive summary with key findings and recommendations.\nIf 'bullets': Create a bulleted list of the main points.\nIf 'detailed': Write a comprehensive summary covering all major topics.\n\nDocument ({input_data.word_count} words):\n\n{input_data.original_text}\n\nSummary:"
      }
    },
    
    "format_result": {
      "type": "python",
      "name": "Format Output",
      "dependencies": ["summarize", "analyze_doc"],
      "code": "output = {\n    'summary': input_data,\n    'original_word_count': context['analyze_doc']['word_count'],\n    'summary_type': context['analyze_doc']['summary_type'],\n    'compression_ratio': round(len(input_data.split()) / context['analyze_doc']['word_count'] * 100, 1) if context['analyze_doc']['word_count'] > 0 else 0\n}"
    },
    
    "output": {
      "type": "output",
      "name": "Summary Result",
      "dependencies": ["format_result"]
    }
  }
}
